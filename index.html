<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>FP_CB</title>
  <link rel="stylesheet" href="estilos.css">
</head>
<body>
  <h1>What is .gtf?</h1>
  
  <h2>It is a format used for biological data, it means: Gene Transfer Format, and it helps to describe the caracteristics of a genome.</h2> 
  
  <p>I used the AI's help(Chatgpt and Gemini) to tranform my file to a .tsv format. The routine is the following one:</p>

  <p>   import csv </p>
  <p>   import re  </p>
  <p>    import sys </p>
        
  <p>  archivo_gtf = "FlatWorm.xenoRefGene.gtf" </p>
  
  <p>      archivo_tsv = "FlatWorm.xenoRefGene.tsv" </p>
        
   <p>  def gtf_a_tsv(archivo_gtf, archivo_tsv): 
             </p> 
   <pre> <p>   """     Convierte un archivo GTF a un archivo TSV, separando los atributos.
            """ </p>
   <p>         # Nombres de las primeras 8 columnas estándar de GTF
            columnas_gtf = [
                "seqname", "source", "feature", "start", "end",
                "score", "strand", "frame"
            ] </p>
      <p>      # Atributos que queremos extraer de la columna 'attributes' </p>
      <p>      atributos_a_extraer = ["gene_id", "transcript_id", "gene_name"] </p>
        
          <p>  try: </p>
       <span style="margin-right: 50px;">    <p>     with open(archivo_gtf, 'r') as infile, open(archivo_tsv, 'w', newline='') as outfile: </p>
           <p>         # Creamos un escritor de TSV, usando tabulador como delimitador </p>
           <p>         tsv_writer = csv.writer(outfile, delimiter='\t')   </p>
        
            <p>        # Escribir la fila de encabezado </p>
           <p>         encabezados = columnas_gtf + atributos_a_extraer  </p>
              <p>      tsv_writer.writerow(encabezados)   </p>
        
            <p>        for linea in infile:   </p>
           <p>             # Ignorar las líneas de comentarios que comienzan con '#'
                        if linea.startswith('#') or linea.strip() == "":
                            continue  </p>
        
               <p>         # El GTF es un archivo delimitado por tabuladores.   </p>
            <p>            # Dividimos la línea en 9 partes (8 columnas estándar + 1 columna de atributos)   </p>
              <p>          campos = linea.strip().split('\t')  </p>
        
           <p>             if len(campos) < 9:    </p>
          <p>               print(f"Advertencia: línea con formato incorrecto, saltando: {linea.strip()}", file=sys.stderr)
                            continue  </p>
        
           <p>             # Extraer las primeras 8 columnas  </p>
           <p>             datos_principales = campos[:8]     </p>  
        
           <p>             # Extraer la columna de atributos </p>
          <p>              columna_atributos = campos[8].strip()          </p>
        
            <p>            # Diccionario para almacenar los atributos clave-valor extraídos  </p>
            <p>            atributos_extraidos = {}       </p>
        
             <p>           # Analizar los atributos        </p>
            <p>            # El patrón busca 'clave "valor";'     </p>
             <p>           # Usamos el módulo 're' (regex) para esto. </p>
           <p>             # Esto es una simplificación; la columna de atributos puede ser más compleja. </p>
             <p>           for clave in atributos_a_extraer: </p>
               <p>             # El patrón busca la clave seguida de espacio, comillas, el valor (no comillas), y ;
                            patron = rf'{re.escape(clave)} \"([^\"]+)\";'
                            match = re.search(patron, columna_atributos) </p>
             <p>               if match:     </p>
               </p>                 # Si encuentra una coincidencia, toma el grupo de captura (el valor)  </p>
               <p>                 atributos_extraidos[clave] = match.group(1) </p>
            <p>                else: </p>
             <p>                   atributos_extraidos[clave] = "" # Vacío si no se encuentra  </p>
        
            <p>            # Construir la fila final para el TSV    </p>
            <p>            fila_tsv = datos_principales + [atributos_extraidos.get(clave, "") for clave in atributos_a_extraer]   </p>
        
            <p>            # Escribir la fila        </p>
           <p>             tsv_writer.writerow(fila_tsv)       </p> </pre>
        
          <p>      print(f"Conversión completa. Archivo TSV guardado en: {archivo_tsv}")    </p>  </span>
        
          <p>  except FileNotFoundError:    </p>
          <p>     print(f"Error: El archivo no fue encontrado.", file=sys.stderr)   </p>
         <p>   except Exception as e:  </p>
           <p>     print(f"Ocurrió un error durante la conversión: {e}", file=sys.stderr)  </p>
        
  <p>       # --- Uso del script ---     </p>
  <p>      if __name__ == "__main__":  </p>
        
    <p>        archivo_gtf_entrada = "FlatWorm.xenoRefGene.gtf" # Reemplaza con tu nombre de archivo GTF      </p>
   <p>         archivo_tsv_salida = "salida_FlatWorm.tsv"   # Nombre para tu nuevo archivo TSV     </p>
        
     <p>         gtf_a_tsv(archivo_gtf_entrada, archivo_tsv_salida)    </p>



  
</body>
</html>

